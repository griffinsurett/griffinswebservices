import{r as i,j as r}from"./react-core.D5E039p9.js";const O=p=>p.toLowerCase().trim().replace(/[^a-z0-9\s-]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-").slice(0,80),E="h2, h3";function H({id:p,className:$="",contentId:h,title:m="Table of Contents",headingSelector:x=E,scrollOffset:C=140,emptyLabel:w="Headings will appear here automatically."}){const g=p??`${h}-toc`,I=`${g}-list`,[u,y]=i.useState([]),[o,B]=i.useState([]),[l,f]=i.useState(null),[S,b]=i.useState({}),j=i.useMemo(()=>x.split(",").map(e=>e.trim()).filter(Boolean).join(", ")||E,[x]);i.useEffect(()=>{const e=document.getElementById(h);if(!e)return;const t=Array.from(e.querySelectorAll(j)).map((s,d)=>{const a=s.textContent?.trim();if(!a)return null;const N=Number.parseInt(s.tagName.replace("H",""),10)||2;return s.id||(s.id=`${h}-${O(a)}-${d}`),s.dataset.tocAnchor=s.id,{id:s.id,text:a,level:N,element:s}}).filter(Boolean),n=[];if(t.forEach(s=>{s.level<=2||n.length===0?n.push({parent:s,children:[]}):n[n.length-1].children.push(s)}),y(t),B(n),t.length>0&&f(s=>s??t[0].id),t.length===0)return;const c=new IntersectionObserver(s=>{s.forEach(d=>{d.isIntersecting&&f(d.target.id)})},{rootMargin:"-45% 0px -45% 0px",threshold:.15});return t.forEach(({element:s})=>c.observe(s)),()=>{c.disconnect()}},[h,j]),i.useEffect(()=>{o.length!==0&&b(()=>{const e={};return o.forEach((t,n)=>{e[t.parent.id]=n===0}),e})},[o]),i.useEffect(()=>{if(!l||o.length===0)return;const e=o.find(t=>t.parent.id===l||t.children.some(n=>n.id===l));e&&b(()=>{const t={};return o.forEach(n=>{t[n.parent.id]=n.parent.id===e.parent.id}),t})},[l,o]);const v=e=>{const t=document.getElementById(e);if(!t)return;const n=window.matchMedia("(prefers-reduced-motion: reduce)"),c=t.getBoundingClientRect().top+window.scrollY-C;window.scrollTo({top:c,behavior:n.matches?"auto":"smooth"}),f(e),history.replaceState(null,"",`#${e}`)},k=(e,t)=>{e.preventDefault(),v(t)},A=(e,t)=>{e.preventDefault(),v(t)},G=u.length===0?"":u.length===1?"1 section":`${u.length} sections`;return r.jsxs("nav",{id:g,className:`table-of-contents-card ${$}`.trim(),"aria-label":m,children:[r.jsxs("div",{className:"table-of-contents-header",children:[r.jsx("p",{className:"table-of-contents-label",children:m}),r.jsx("span",{className:"table-of-contents-count","aria-live":"polite",children:G})]}),r.jsx("ol",{id:I,className:"table-of-contents-list",children:o.length===0?r.jsx("li",{className:"table-of-contents-placeholder",children:w}):o.map((e,t)=>{const n=e.parent.id,c=!!S[n],s=l===n||e.children.some(a=>a.id===l),d=`${n}-children`;return r.jsxs("li",{className:"table-of-contents-item",children:[r.jsxs("button",{type:"button",className:`toc-parent-trigger ${s?"is-active":""}`,"aria-expanded":c,"aria-controls":d,onClick:a=>k(a,n),children:[r.jsx("span",{className:"toc-label",children:e.parent.text}),r.jsx("span",{className:`toc-caret ${c?"is-open":""}`,"aria-hidden":"true",children:"â–¾"})]}),e.children.length>0&&r.jsx("ol",{id:d,className:`toc-children ${c?"is-open":""}`,children:e.children.map((a,N)=>r.jsx("li",{children:r.jsx("a",{href:`#${a.id}`,className:"toc-child-link","aria-current":a.id===l,onClick:M=>A(M,a.id),children:r.jsx("span",{className:"toc-label",children:a.text})})},a.id))})]},n)})})]})}export{H as default};
