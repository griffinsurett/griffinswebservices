import{r}from"./react-core.LlkHSr3O.js";import{s as H,c as S}from"./scroll-observer.BBND9qH0.js";function z(t){return t?.current?t.current:typeof window<"u"?window:null}function P(t){return t?t===window?typeof window<"u"&&window.scrollY||0:t.scrollTop||0:0}const X=({elementRef:t,scrollThreshold:f=10,debounceDelay:y=150,trustedOnly:Y=!0,internalFlagRef:i,wheelSensitivity:g=1,onScrollActivity:M,onScrollUp:h,onScrollDown:d,onScrollStart:T,onScrollEnd:v,onDirectionChange:x,onWheelActivity:V}={})=>{const a=r.useRef(null),p=r.useRef(0),l=r.useRef("none"),w=r.useRef(!1),o=r.useRef(null),s=r.useCallback(()=>{a.current&&(clearTimeout(a.current),a.current=null)},[]),E=r.useCallback(()=>{s(),a.current=setTimeout(()=>{if(w.current){w.current=!1;const e=o.current,u=l.current;v?.({pos:P(e),dir:u==="none"?"down":u})}},y)},[s,y,v]),b=r.useCallback((e,u)=>{if(Math.abs(e)<f)return;const n=o.current,c=P(n),L=e>0?"down":"up";w.current||(w.current=!0,T?.({pos:c,dir:L,source:u})),L!==l.current&&l.current!=="none"&&x?.({from:l.current,to:L,pos:c,source:u}),l.current=L;const $={dir:L,delta:Math.abs(e),pos:c,source:u};M?.($),L==="down"?d?.($):h?.($),E()},[M,d,T,h,x,E,f]);r.useEffect(()=>{const e=z(t);o.current=e,p.current=P(e)},[t]);const m=!t||t.current===null;return r.useEffect(()=>{if(!m||i?.current)return;const e=n=>{const c=n.scrollY-p.current;p.current=n.scrollY,c!==0&&b(c,n.source)};return H.subscribe(e)},[m,b,i]),r.useEffect(()=>{if(m)return;const e=o.current||z(t);if(!e||e===window)return;const u=n=>{if(Y&&!n.isTrusted||i?.current)return;const c=(n.deltaY||0)*g;c!==0&&(V?.({deltaY:c,deltaX:n.deltaX||0,deltaZ:n.deltaZ||0,deltaMode:n.deltaMode,event:n}),b(c,"wheel"))};return e.addEventListener("wheel",u,{passive:!0}),()=>e.removeEventListener("wheel",u)},[m,t,b,i,V,Y,g]),r.useEffect(()=>{if(m)return;const e=o.current||z(t);if(!e||e===window)return;const u=()=>{if(i?.current)return;const n=P(e),c=n-p.current;p.current=n,c!==0&&b(c,"scroll")};return e.addEventListener("scroll",u,{passive:!0}),()=>e.removeEventListener("scroll",u)},[m,t,b,i]),r.useEffect(()=>()=>s(),[s]),{getCurrentPos:()=>P(o.current),getLastPos:()=>p.current,getLastDir:()=>l.current,isScrolling:()=>w.current}};function Z(t){if(typeof t=="number")return`0px 0px ${t}px 0px`;const f=String(t??"").trim();return/^-?\d+px$/.test(f)?`0px 0px ${f} 0px`:f||"0px"}function I(t,{threshold:f=.1,root:y=null,rootMargin:Y="0px",once:i=!1,onEnter:g,onExit:M,onForward:h,onBackward:d,pauseDelay:T=100,restoreAtTopOffset:v=100,menuCheckboxId:x}={}){const[V,a]=r.useState(!1),[p,l]=r.useState(!1),w=r.useMemo(()=>Z(Y),[Y]);r.useEffect(()=>{const s=t?.current;if(!s)return;const{isVisible:E,hasBeenSeen:b,disconnect:m}=S(s,{threshold:f,root:y,rootMargin:w,once:i,onEnter:e=>{a(!0),l(!0),g?.(e)},onExit:e=>{a(!1),M?.(e)}});return a(E),l(b),m},[t,f,y,w,i,g,M]);const o=typeof h=="function"||typeof d=="function";return X({elementRef:null,scrollThreshold:5,debounceDelay:T,onScrollActivity:o?({dir:s})=>{s==="down"?h?.():typeof window<"u"&&window.pageYOffset<=v&&d?.()}:void 0}),r.useEffect(()=>{if(!x||!o||typeof document>"u")return;const s=document.getElementById(x);if(!s)return;const E=()=>{s.checked?d?.():typeof window<"u"&&window.pageYOffset>v?h?.():d?.()};return s.addEventListener("change",E),E(),()=>s.removeEventListener("change",E)},[x,d,h,v,o]),i?p:V}export{X as a,z as r,I as u};
