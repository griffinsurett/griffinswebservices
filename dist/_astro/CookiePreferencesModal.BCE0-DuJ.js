import{r,j as t}from"./react-core.LlkHSr3O.js";import{M as S}from"./Modal.B8WZ_q5T.js";import{u as T,e as N}from"./scriptManager.CdcrpAwd.js";import{B as y,b as E}from"./accordion.CtcpJbxu.js";import{I as M}from"./ui-primitives.D8SQ66mI.js";import"./consent.DTnIOFqc.js";import"./scroll-observer.Bo5DAR6D.js";import"./visibility-hooks.DGi75yjJ.js";import"./engagement-hooks.D7FwOgju.js";function I({label:m,description:i,checked:a,onChange:u,disabled:n=!1,note:f,id:k,bordered:h=!0,className:v="",hideText:w=!1,size:x="md"}){const p=r.useId(),c=k??p,g=`${c}-label`,b=i?`${c}-description`:void 0,d=x==="lg"?{track:"h-7 w-12",thumb:"h-5 w-5",on:"translate-x-6",off:"translate-x-1"}:x==="sm"?{track:"h-5 w-9",thumb:"h-3.5 w-3.5",on:"translate-x-5",off:"translate-x-1"}:{track:"h-6 w-11",thumb:"h-4 w-4",on:"translate-x-6",off:"translate-x-1"},e=s=>{s.stopPropagation(),!n&&u(!a)};return t.jsxs("div",{className:`flex items-start justify-between gap-4 ${h?"border-b border-surface last:border-b-0":""} ${v}`,children:[t.jsxs("div",{className:`flex-1 pr-4 ${n?"cursor-not-allowed":"cursor-pointer"}`,onClick:e,role:"presentation",children:[t.jsx("p",{id:g,className:`font-semibold text-heading ${w?"sr-only":""}`,children:m}),i&&t.jsx("p",{id:b,className:`text-sm text-text mt-1 ${w?"sr-only":""}`,children:i})]}),t.jsxs("div",{className:"flex flex-col items-end gap-1",children:[f&&t.jsx("span",{className:"text-xs font-semibold text-primary",children:f}),t.jsx("button",{type:"button",id:c,role:"switch","aria-checked":a,"aria-labelledby":g,"aria-describedby":b,"aria-disabled":n,disabled:n,onClick:e,className:`relative inline-flex ${d.track} items-center rounded-full transition-colors focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2 ${a?"bg-primary":"bg-text/20"} ${n?"opacity-60 cursor-not-allowed":""}`,children:t.jsx("span",{className:`inline-block ${d.thumb} transform rounded-full bg-bg transition-transform shadow ${a?d.on:d.off}`})})]})]})}const C=[{id:"necessary",title:"Strictly Necessary Cookies",description:"These cookies are essential for the website to function properly. They enable core functionality such as security, network management, and accessibility.",required:!0},{id:"functional",title:"Functional Cookies",description:"These cookies enable the website to provide enhanced functionality and personalization. They may be set by us or by third party providers."},{id:"performance",title:"Performance Cookies",description:"These cookies allow us to count visits and traffic sources so we can measure and improve the performance of our site."},{id:"targeting",title:"Targeting Cookies",description:"These cookies may be set through our site by our advertising partners to build a profile of your interests and show you relevant adverts."}];function P({isOpen:m,onClose:i}){const{getCookie:a,setCookie:u}=T(),[n,f]=r.useTransition(),k=r.useMemo(()=>{const e=a("cookie-consent");if(e)try{return JSON.parse(e)}catch(s){console.error("Failed to parse cookie consent:",s)}return{necessary:!0,functional:!1,performance:!1,targeting:!1,timestamp:Date.now()}},[a]),[h,v]=r.useState(k),[w,x]=r.useState(!1),p=r.useRef(null);r.useEffect(()=>{const e=p.current;if(!e)return;const s=()=>{const l=e.scrollHeight>e.clientHeight,o=e.scrollTop+e.clientHeight>=e.scrollHeight-10;x(l&&!o)};return s(),e.addEventListener("scroll",s,{passive:!0}),window.addEventListener("resize",s,{passive:!0}),()=>{e.removeEventListener("scroll",s),window.removeEventListener("resize",s)}},[m]);const c=C.map((e,s)=>({slug:e.id,title:e.title,description:e.description,contentSlotId:`cookie-category-${s}-content`})),g=(e,s)=>{e!=="necessary"&&v(l=>({...l,[e]:typeof s=="boolean"?s:!l[e]}))},b=()=>{const e={necessary:!0,functional:!1,performance:!1,targeting:!1,timestamp:Date.now()};u("cookie-consent",JSON.stringify(e),{expires:365}),N(),window.dispatchEvent(new Event("consent-changed")),f(()=>{i()})},d=()=>{const e={...h,timestamp:Date.now()};u("cookie-consent",JSON.stringify(e),{expires:365}),N(),window.dispatchEvent(new Event("consent-changed")),f(()=>{i()})};return t.jsxs(S,{isOpen:m,onClose:i,closeButton:!0,className:"bg-bg rounded-2xl p-8 max-w-3xl w-full mx-4 max-h-[90vh] flex flex-col shadow-2xl",overlayClass:"bg-black/60",ariaLabel:"Manage cookie consent preferences",ssr:!1,children:[t.jsxs("div",{className:"mb-6 shrink-0",children:[t.jsx("h2",{className:"text-3xl font-bold text-heading mb-4",children:"Manage Consent Preferences"}),t.jsxs("p",{className:"text-text text-xs lg:text-sm leading-relaxed mb-3",children:["We use cookies and similar technologies to help personalize content and offer a better experience. You can click"," ",t.jsx(y,{variant:"link",href:"/cookie-policy",children:"here"})," ","to find out more and change our default settings. However, blocking some types of cookies may impact your experience of the site and the services we are able to offer."]}),t.jsxs(y,{variant:"link",href:"/cookie-policy",children:["More information",t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]})]}),t.jsx("div",{className:"relative flex-1 min-h-0",children:t.jsxs("div",{ref:p,className:"overflow-y-auto max-h-[40vh] pr-2",children:[t.jsx(E,{allowMultiple:!0,className:"space-y-3",items:c,showIndicator:!1,headerSlot:({item:e,id:s,expanded:l})=>{const o=C.find(j=>j.id===e.slug);if(!o)return null;const $=`${s}-toggle`;return t.jsxs("div",{className:"flex items-center gap-3 w-full",children:[t.jsx("div",{className:`w-9 h-9 rounded-full flex items-center justify-center transition-all duration-500 text-lg font-semibold ${l?"bg-primary text-bg":"bg-primary/20 text-accent"}`,"aria-hidden":"true",children:t.jsx(M,{icon:l?"lucide:minus":"lucide:plus",size:"sm",className:"w-4 h-4"})}),t.jsx("span",{className:"font-semibold text-heading text-base flex-1",children:o.title}),t.jsxs("div",{className:"shrink-0 flex items-center gap-3",children:[o.required&&t.jsx("span",{className:"text-sm font-semibold text-primary",children:"Always Active"}),t.jsx(I,{label:o.title,description:o.description,checked:h[o.id],onChange:j=>g(o.id,j),disabled:o.required,id:$,bordered:!1,className:"py-0",hideText:!0,size:"lg"})]})]})}}),c.map((e,s)=>t.jsx("div",{id:`cookie-category-${s}-content`,style:{display:"none"},children:t.jsx("p",{className:"text-sm text-text leading-relaxed",children:e.description})},e.slug))]})}),t.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 mt-6 pt-4 shrink-0",children:[t.jsx(y,{variant:"secondary",onClick:b,className:"flex-1",type:"button",disabled:n,children:"Reject All"}),t.jsx(y,{variant:"primary",onClick:d,className:"flex-1",animated:!1,type:"button",disabled:n,children:"Confirm My Choices"})]})]})}const O=r.memo(P);export{O as default};
