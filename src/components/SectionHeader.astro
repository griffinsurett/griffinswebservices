---
// src/components/SectionHeader.astro
import BorderTitle from "@/components/BorderTitle";
import Heading from "@/components/Heading";
import ContentHeading from "@/components/ContentHeading.astro";
import type { ReactNode } from "react";
import type { VisibleRootMargin } from "@/components/AnimatedBorder/AnimatedBorder";
import type { HeadingContent } from "@/content/schema";

interface Props {
  title?: ReactNode;
  titleClassName?: string;
  titlePillClassName?: string;
  titleVisibleRootMargin?: VisibleRootMargin;
  heading?: ReactNode;
  contentHeading?: HeadingContent | null;
  headingBefore?: ReactNode;
  headingEmphasis?: ReactNode;
  headingAfter?: ReactNode;
  headingTag?: string;
  headingClassName?: string;
  emphasisClassName?: string;
  description?: ReactNode;
  descriptionClassName?: string;
  className?: string;
  headerProps?: Record<string, unknown>;
}

const {
  title,
  titleClassName = "",
  titlePillClassName,
  titleVisibleRootMargin,
  heading,
  contentHeading,
  headingBefore,
  headingEmphasis,
  headingAfter,
  headingTag = "h2",
  headingClassName = "h2 mb-6",
  emphasisClassName = "emphasized-text",
  description,
  descriptionClassName = "large-text",
  className = "text-section",
  headerProps = {},
} = Astro.props as Props;

const hasSegmentedHeading =
  headingBefore !== undefined ||
  headingEmphasis !== undefined ||
  headingAfter !== undefined;

const hasContentHeading = contentHeading !== undefined && contentHeading !== null;
---

<div class={className}>
  {title && (
    <BorderTitle
      client:visible
      className={titleClassName}
      pillClassName={titlePillClassName}
      visibleRootMargin={titleVisibleRootMargin}
    >
      {title}
    </BorderTitle>
  )}

  {hasContentHeading ? (
    <ContentHeading
      heading={contentHeading}
      tagName={headingTag}
      className={headingClassName}
      textClass={emphasisClassName}
      {...headerProps}
    />
  ) : hasSegmentedHeading ? (
    <Heading
      tagName={headingTag}
      className={headingClassName}
      before={headingBefore}
      text={headingEmphasis}
      after={headingAfter}
      textClass={emphasisClassName}
      {...headerProps}
    />
  ) : (
    heading && (
      <Heading tagName={headingTag} className={headingClassName} {...headerProps}>
        {heading}
      </Heading>
    )
  )}

  {description && <p class={descriptionClassName}>{description}</p>}
</div>
