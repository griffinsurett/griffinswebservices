---
// src/components/LoopTemplates/MasonryGrid.astro
/**
 * MasonryGrid - 2-column layout with balanced distribution
 * Each card is rendered as a slot for individual hydration
 * Cards fade in on scroll
 */

export interface MasonryCardData {
  title: string;
  description?: string;
  icon?: string;
  order?: number;
  Content?: any;
}

interface Props {
  items: MasonryCardData[];
  className?: string;
}

const { items, className = "" } = Astro.props;

// Explicit column assignments for balanced heights
const leftColumnTitles = [
  "Lightning-Fast Websites",
  "Designed to Stand Out on Every Device",
  "Designed to Grow With You",
];

const rightColumnTitles = [
  "SEO From the Foundations",
  "Future-Ready & AI-Prepared",
  "Security-Minded by Design",
  "Support That Sticks Around",
];

// Build columns based on explicit assignments
const leftColumn = leftColumnTitles
  .map(title => items.find(item => item.title === title))
  .filter((item): item is MasonryCardData => item !== undefined);

const rightColumn = rightColumnTitles
  .map(title => items.find(item => item.title === title))
  .filter((item): item is MasonryCardData => item !== undefined);
---

<div class={`masonry-grid ${className}`}>
  <div class="masonry-column">
    {leftColumn.map((item) => (
      <article
        class="masonry-card"
        data-animate="fade-in-up"
        data-animate-threshold="0.15"
        data-animate-root-margin="-10% 0px -10% 0px"
      >
        <h3 class="text-xl font-semibold text-text mb-2">{item.title}</h3>
        {item.description && (
          <p class="text-sm text-text/60 leading-relaxed">{item.description}</p>
        )}
        {item.Content && (
          <div class="masonry-content mt-4">
            <item.Content />
          </div>
        )}
      </article>
    ))}
  </div>
  <div class="masonry-column">
    {rightColumn.map((item) => (
      <article
        class="masonry-card"
        data-animate="fade-in-up"
        data-animate-threshold="0.15"
        data-animate-root-margin="-10% 0px -10% 0px"
      >
        <h3 class="text-xl font-semibold text-text mb-2">{item.title}</h3>
        {item.description && (
          <p class="text-sm text-text/60 leading-relaxed">{item.description}</p>
        )}
        {item.Content && (
          <div class="masonry-content mt-4">
            <item.Content />
          </div>
        )}
      </article>
    ))}
  </div>
</div>
